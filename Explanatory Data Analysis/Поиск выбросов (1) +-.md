Что такое выброс и зачем нам их нужно искать? 
По факту, выбросы это значения, которые отбиваются от выбранной интерпретации данных, которые попадаются очень редко.
Вообще, с этим все довольно просто: выбросы могут довольно сильно повлиять на предсказания нашей модели, т.к. имеют очень сильное влияние из-за экстремально больших или же малых чисел. Допустим, что у нас применяется стохастический градиентный спуск и практически все значения в диапазоне 1-10. Появляется у нас sample с признаком в 100000000, из-за чего это критично повлияет на модель. $w = w - \lambda (100000000 - 5)$, где 5 это условно предсказание модели, а большое число - выброс.

Разделить анализ выбросов можно на два вида: статистические и визуальные, но чаще всего рассматривают на графиках, т.к. данные могут быть зависимы нелинейно, без визуализации будет урезанный контекст о выбросах, что повлияет на качество обработки данных в худшую сторону.

Импортируем парочку библиотек и сгенерируем данные:

``` python
import numpy as np
import pandas as pd

def generate_dataset():
    data_normal = np.random.normal(loc=50, scale=10, size=100)
    outliers = np.array([10, 120, 130])
    return np.concatenate([data_normal, outliers])

df = pd.DataFrame({"Values": generate_dataset()})
```

Сначала посмотрим на то, как мы визуально отлавливаем выбросы:
Нарисуем для этого
- Boxplot
- Scatter plot
- Histogram

``` python
import matplotlib.pyplot as plt
import seaborn as sns

fig, axes = plt.subplots(1, 3, figsize=(18, 5))

sns.boxplot(x=df["Values"], ax=axes[0])
axes[0].set_title("Boxplot")

axes[1].scatter(range(len(df)), df["Values"], color='blue')
axes[1].set_title("Scatter Plot")
axes[1].set_xlabel("Index")
axes[1].set_ylabel("Values")

sns.histplot(df["Values"], bins=20, kde=True, ax=axes[2])
axes[2].set_title("Histogram")

plt.show()
```

![Image alt](https://raw.githubusercontent.com/DanisSharafiev/MLCourse/refs/heads/main/Images/Outliers.png)

Легко заметить, что некоторые данные у нас выбиваются. Для удобности я отметил их красным цветом.
Разберем по отдельности:
У Boxplot есть так называемые усики. Они работают по принципу IQR, его разберу ниже, пока будет достаточно знать того, что точки за усиками - скорее всего выбросы, либо стоит их проверить.
На Scatterplot пришлось визуализировать каждую точку по порядку (я использовал range, хотя так делать не советую, лучше сравнивать с другими признаками, если они есть), т.к. у нас только одна переменная, тем не менее заметно, что 3 точки выбиваются, здесь так же явно заметны отличия в данных.
У Histogram видно, что отбивается 3 ведерка, где между первым выбросом и основной кучкой данных видно: только одно свободное, по идее не так уж и страшно (но стоит все равно перепроверить), и в другом промежутке уже очень много свободных, это плохо, ведь заметно явное отклонение от основной части данных.

Рассмотрю статистические приемы:

Метод межквартильного размаха (IQR)


``` python
Q1 = data["Values"].quantile(0.25)
Q3 = data["Values"].quantile(0.75)

IQR = Q3 - Q1
low = Q1 - 1.5 * IQR
high = Q3 + 1.5 * IQR

data[(data["Values"] >= low) & (data["Values"] <= high)]
```

Метод Z-оценки:
$Z = \frac{x-mean}{std}$

``` python
column = df["Values"]

mean = column.mean()
std = column.std()

z_scores = (column - mean) / std

df[np.abs(z_scores) < 2.5]
```

