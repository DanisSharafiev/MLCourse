Кодирование - обработка категориальных данных для последующего использования в ML алгоритмах.
### One-hot Encoding
Лучше использовать, когда категории не имеют порядка и мало уникальных значений (на каждое уникальное значение создается свой столбец).
Из минусов: увеличивает размерность, для бустинга может не подходить. Это из-за того, что бустинг способен эффективно работать и без кодирования по отдельным столбцам, помимо этого занимает большое количество вычислительной мощности.

``` python
import pandas as pd

df = pd.DataFrame({'Cost': ['cheap', 'expensive', 'acceptable', 'cheap']})
pd.get_dummies(df, columns=['Sword'], dtype=int)
```

```
    Cost_acceptable  Cost_cheap  Cost_expensive 
0                 0           1               0 
1                 0           0               1 
2                 1           0               0 
3                 0           1               0
```

dtype=int переводит boolean (True или False) в 1 и 0.

### Ordinal (С заданным порядком)

Этот вид кодирования существует для порядковых категорий. С заданным порядком дает числа (0, 1, 2 и т.д.). Заменяет просто числами. Если классы не имеют естественного порядка, то он не подходит.
Перед использованием стоит убедиться, что данный вид подходит для алгоритма (древесные модели, линейные модели, KNN, SVM).


``` python
from sklearn.preprocessing import OrdinalEncoder

df = pd.DataFrame({'Cost': ['cheap', 'expensive', 'acceptable', 'cheap']})
encoder = OrdinalEncoder(categories = [['cheap', 'acceptable', 'expensive']])
encoder.fit_transform(df[['Cost']])
```

```
array([[0.], 
       [2.], 
       [1.], 
       [0.]])
```

### Mean target encoding

Большой риск переобучения (особенно при редких категориях). Может произойти утечка данных, подходит для бустинга. 

``` python
df = pd.DataFrame({'Size': ['Small', 'Average', 'Big', 'Small'],
                   'Price': [50, 110, 150, 60]})
  
mean_target = df.groupby('Size')['Price'].mean()
df['Size'].map(mean_target)
```

```
0 55.0 
1 110.0 
2 150.0 
3 55.0 
Name: Size, dtype: float64
```

### Manual encoding

Вид кодирования, который может быть субъективным в зависимости от задачи, однако простой и интерпретируемый. Подходит для категорий с известной логикой преобразования.

``` python
df = pd.DataFrame({'Size': ['Small', 'Medium', 'Big', 'Small']})
size_mapping = {'Small': 10, 'Medium': 22, 'Big': 50}
df['Size'].map(size_mapping)
```

``` console
0    10
1    22
2    50
3    10
Name: Size, dtype: int64
```


